\tikzstyle{cleartext} = [rectangle, rounded corners,minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=orange!30]
\tikzstyle{plaintext} = [rectangle, rounded corners,minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=purple!30]
\tikzstyle{ciphertext} = [rectangle, rounded corners,minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=themecolor!30]
\tikzstyle{arrow} = [thick,->,>=stealth]

\begin{tikzpicture}
  \node[plaintext, align = center] (p) at (5,0) {plaintext \\ $m(X)$};
  \node[ciphertext, align = center] (c) at (12,0) {ciphertext \\ $\vec{c} = (c_0(X), c_1(X))$};

  \node[plaintext, align = center] (p2) at (5,-2.0) {plaintext \\ $\tilde{m}(X) = f(m(X))$};
  \node[ciphertext, align = center] (c2) at (12,-2.0) {ciphertext \\ $\tilde{\vec{c}} = f(\vec{c})$};

  \draw (p.north) node[above]{$\Z_t[X]/(X^N + 1)$};
  \draw (p2.south) node[below]{$\Z_t[X]/(X^N + 1)$};
  \draw (c.north) node[above]{$(\Z_q[X]/(X^N + 1))^2$};
  \draw (c2.south) node[below]{$(\Z_q[X]/(X^N + 1))^2$};

  \draw [arrow] (p) -- node[anchor=south] {encryption} (c);
  \draw [arrow] (c) -- node[anchor=east] {computing $f$} (c2);
  \draw [arrow] (c2) -- node[anchor=south] {decryption} (p2);
\end{tikzpicture}
